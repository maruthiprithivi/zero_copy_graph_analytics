# PuppyGraph Configuration Properties
# Customer 360 Demo - Production-Ready Configuration for 2025

#============================================================================
# Server Configuration
#============================================================================

# HTTP server port for Web UI
server.port=8081

# Bind address (0.0.0.0 for all interfaces in container/cloud environments)
server.host=0.0.0.0

# Enable HTTPS (set to true for production with proper certificates)
server.ssl.enabled=false

# SSL configuration (uncomment and configure for production)
# server.ssl.key-store=/etc/puppygraph/ssl/keystore.jks
# server.ssl.key-store-password=changeit
# server.ssl.key-password=changeit

#============================================================================
# Authentication and Security
#============================================================================

# Enable authentication (always true for production)
auth.enabled=true

# Default admin user credentials (change in production)
auth.admin.username=${PUPPYGRAPH_USERNAME}
auth.admin.password=${PUPPYGRAPH_PASSWORD}

# Session timeout in minutes
auth.session.timeout=120

# Enable API key authentication for programmatic access
auth.apikey.enabled=true

# CORS configuration for web applications
cors.enabled=true
cors.allowed.origins=*
cors.allowed.methods=GET,POST,PUT,DELETE,OPTIONS
cors.allowed.headers=*
cors.max.age=3600

#============================================================================
# Query Engine Configuration
#============================================================================

# Default query timeout in seconds
query.timeout.default=300

# Maximum query timeout in seconds (10 minutes for complex graph operations)
query.timeout.max=600

# Maximum number of concurrent queries
query.concurrency.max=50

# Enable query result caching
query.cache.enabled=true

# Query cache size in MB
query.cache.size.mb=512

# Query cache TTL in minutes
query.cache.ttl.minutes=30

# Maximum result set size (prevent memory issues)
query.result.max.size=1000000

# Enable query performance monitoring
query.monitoring.enabled=true

# Slow query threshold in milliseconds
query.monitoring.slow.threshold=5000

#============================================================================
# Memory Management
#============================================================================

# JVM heap size limits (set via environment variables in Docker)
# -Xms: Initial heap size
# -Xmx: Maximum heap size
# These are set in docker-compose.yml via JAVA_OPTS

# Enable G1 garbage collector for better performance with large graphs
jvm.gc.g1.enabled=true

# G1 max GC pause time target in milliseconds
jvm.gc.g1.max.pause.ms=200

# Enable string deduplication to save memory
jvm.string.dedup.enabled=true

#============================================================================
# Graph Engine Configuration
#============================================================================

# Enable graph statistics collection for query optimization
graph.statistics.enabled=true

# Statistics collection interval in minutes
graph.statistics.interval.minutes=60

# Enable parallel query execution
graph.parallel.execution.enabled=true

# Number of parallel execution threads (auto-detect based on CPU cores)
graph.parallel.threads=auto

# Enable index hints for query optimization
graph.index.hints.enabled=true

# Graph traversal depth limit (prevent infinite loops)
graph.traversal.max.depth=10

# Maximum number of vertices to return in a single query
graph.vertices.max.return=100000

# Maximum number of edges to return in a single query  
graph.edges.max.return=100000

#============================================================================
# Database Connection Pooling
#============================================================================

# Connection pool initial size
datasource.pool.initial.size=5

# Connection pool maximum size
datasource.pool.max.size=20

# Connection pool minimum idle connections
datasource.pool.min.idle=2

# Connection pool maximum idle connections
datasource.pool.max.idle=10

# Connection pool validation query
datasource.pool.validation.query=SELECT 1

# Test connections on borrow
datasource.pool.test.on.borrow=true

# Test connections while idle
datasource.pool.test.while.idle=true

# Connection pool eviction thread run interval in milliseconds
datasource.pool.eviction.interval.ms=30000

# Connection timeout in milliseconds
datasource.connection.timeout.ms=30000

# Query timeout in milliseconds
datasource.query.timeout.ms=300000

#============================================================================
# Logging Configuration
#============================================================================

# Root log level (DEBUG, INFO, WARN, ERROR)
logging.level.root=INFO

# PuppyGraph specific log level
logging.level.puppygraph=INFO

# Query log level (set to DEBUG to log all queries)
logging.level.puppygraph.query=INFO

# Performance log level
logging.level.puppygraph.performance=INFO

# Log file location
logging.file.name=/var/log/puppygraph/puppygraph.log

# Log file max size
logging.file.max.size=100MB

# Number of log files to keep
logging.file.max.history=10

# Log pattern for better debugging
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n

# Enable access log for HTTP requests
logging.access.enabled=true
logging.access.file=/var/log/puppygraph/access.log

#============================================================================
# Monitoring and Metrics
#============================================================================

# Enable JMX for monitoring
jmx.enabled=true

# JMX port
jmx.port=9999

# Enable Micrometer metrics (for Prometheus integration)
metrics.enabled=true

# Metrics endpoint path
metrics.endpoint.path=/actuator/metrics

# Enable health check endpoint
health.check.enabled=true

# Health check endpoint path
health.check.endpoint.path=/api/health

# Custom health checks
health.check.datasource.enabled=true
health.check.memory.enabled=true
health.check.disk.enabled=true

#============================================================================
# Performance Tuning
#============================================================================

# Enable query plan caching
query.plan.cache.enabled=true

# Query plan cache size
query.plan.cache.size=1000

# Enable prepared statement caching
prepared.statement.cache.enabled=true

# Prepared statement cache size
prepared.statement.cache.size=500

# Enable result streaming for large queries
result.streaming.enabled=true

# Streaming batch size
result.streaming.batch.size=10000

# Enable compression for large result sets
result.compression.enabled=true

#============================================================================
# Schema Management
#============================================================================

# Schema validation on startup
schema.validation.enabled=true

# Auto-reload schema changes (disable in production)
schema.auto.reload.enabled=false

# Schema file location (relative to PuppyGraph config directory)
schema.file.path=/etc/puppygraph/schema.json

# Enable schema version checking
schema.version.check.enabled=true

#============================================================================
# Backup and Recovery
#============================================================================

# Enable automatic query log backup
backup.query.log.enabled=false

# Query log backup interval in hours
backup.query.log.interval.hours=24

# Query log backup retention in days
backup.query.log.retention.days=7

#============================================================================
# Development and Debug Features
#============================================================================

# Enable debug mode (disable in production)
debug.mode.enabled=false

# Enable query profiling
profiling.enabled=false

# Enable detailed error messages
error.messages.detailed=true

# Enable CORS for development (restrict in production)
dev.cors.enabled=true

#============================================================================
# Advanced Configuration
#============================================================================

# Custom thread pool size for async operations
async.thread.pool.size=10

# Enable experimental features
experimental.features.enabled=false

# Custom query engine features
query.engine.vectorization.enabled=true
query.engine.predicate.pushdown.enabled=true
query.engine.join.optimization.enabled=true

# Network configuration
network.timeout.connect.ms=5000
network.timeout.read.ms=30000

# Custom classloader isolation
classloader.isolation.enabled=true

#============================================================================
# Integration Configuration
#============================================================================

# Enable REST API
rest.api.enabled=true

# REST API base path
rest.api.base.path=/api/v1

# Enable GraphQL endpoint
graphql.enabled=false

# Enable WebSocket support for real-time queries
websocket.enabled=true

# WebSocket endpoint path
websocket.endpoint.path=/ws

#============================================================================
# Vendor-Specific Optimizations
#============================================================================

# ClickHouse specific optimizations
clickhouse.compression.enabled=true
clickhouse.batch.size=10000
clickhouse.parallel.queries.enabled=true
clickhouse.use.native.client=false

# Optimize for time-series data (common in customer analytics)
timeseries.optimization.enabled=true
timeseries.partition.pruning.enabled=true

#============================================================================
# Compliance and Audit
#============================================================================

# Enable audit logging for compliance
audit.logging.enabled=true

# Audit log file location
audit.log.file=/var/log/puppygraph/audit.log

# Audit events to log
audit.events=LOGIN,LOGOUT,QUERY,SCHEMA_CHANGE,CONFIG_CHANGE

# Enable data privacy features
privacy.anonymization.enabled=false
privacy.pii.detection.enabled=false

#============================================================================
# Resource Limits and Circuit Breakers
#============================================================================

# Maximum memory per query in MB
resource.limits.query.memory.mb=1024

# Maximum CPU time per query in seconds
resource.limits.query.cpu.seconds=300

# Circuit breaker for database connections
circuit.breaker.db.enabled=true
circuit.breaker.db.failure.threshold=10
circuit.breaker.db.timeout.ms=60000

# Circuit breaker for memory usage
circuit.breaker.memory.enabled=true
circuit.breaker.memory.threshold.percent=90